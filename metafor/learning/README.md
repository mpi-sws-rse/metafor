# Learning from Simulation Data   



## ðŸ“¦ Data Generation    

To generate data:    

```bash
cd data_generation/   
python data_generator.py  --runs=100   
```
This generates a file "discrete_results_.pkl" which stores the summary data  
from the simulation and used for generating plots. Additionally, it also    
generates a file "discrete_results.pdf" which shows the average queue length    
and latency for the simulations. We can infer metastability from these plots as well.

The above command generates a dataset consisting of $runs$ number of csv files.   
Similarly, other arguments can be passed to the data generator file.   
To ensure backward compatibility, the pkl files can be generated by adding    
"--genpkl=True" to the above command.   

To generate data in multiserver setting:    

```bash 
python data_generator_multi.py  --runs=10
```
Note that this command generates individual files for each server as in case of    
single-sever setting. Consequently, each set of files associated with a server    
would be used to learn the model for that server (described in the next section).    



## ðŸš€ Learning the model       

To learn the Koopman based autoencoder model, goto the learning/ folder and run      

```bash 
python learning_from_simulation_data.py       
```
This generates a file "learned_model.pkl" which stores the all the variables associated
with the learned model.
In the multi-server setting with two servers, we learn two models by running the script two    
times, each with data for the corresponding server.    



## ðŸš€ Analysing the model       

To compute the settling time from the simulation and the theoretical upper bound:      

```bash 
python utils/exp_mixing_time_simulation.py
```

To compute the settling time from the learned Koopman matrix:      

```bash 
python utils/exp_mixing_time_learned.py
```

To compute the settling time from the learned Koopman matrix in the multiserver setting:      

```bash 
python utils/exp_mixing_time_learned_multi.py
```

To compare multiple simulations runs:      

```bash 
python utils/compare_simulations.py
```


